# 数学初步

## 快速幂

问题：给定正整数 $a,b$，求 $a^b \mod m$，其中 $a,b \le 10^{18},m=998244353$。

考察最暴力的做法，必然远远超出题目所给出的时间限制。

一种看起来不错的做法：分块。

如何更好的去做？

考虑将 $b$ 转写成二进制。依结合律，容易得到 $a^b=\prod{a^{2^i}}$，其中 $i$ 为 $b$ 的二进制表达下为 $1$ 的位置。只需算出 $\log b$ 项 $a$ 的幂，在选择有效位置相乘即可。

如何用代码实现这一过程？

## 辗转相除法

问题：给定正整数 $a,b$，求 $\gcd(a,b)$，其中 $a,b\le 10^{18}$。

考察 $\gcd$ 的性质？

不妨假定 $a\ge b$，则易得 $\gcd(a,b)=\gcd(b,a-b)$。如何利用这一性质来解决问题？

递降法：将原问题不断转变为规模更小的问题，直至问题可以被容易的解决。如何加快递降的速率？

辗转相减是成立的，而进一步的，有 $\gcd(a,b)=\gcd(b,a \mod b)$。

如何用代码简便的实现这一过程？试分析这一算法的时间复杂度？

## 乘法逆元

问题：给定 $p$，求 $q$ 使得 $p\times q \equiv 1\pmod m $，其中 $m$ 为质数，$0<p< m$。

问题的另一种表述：给定 $p$，求 $p^{-1}\mod m$，不难发现这一过程实际上是在对有理数取模。 

- 引理一：对 $(m,c)=1$，若 $a\cdot c\equiv b\cdot c \pmod m$，则 $a\equiv b \pmod m$。

  证明：移项后消去 $c$ 即可。

费马小定理：对 $a,p\in \text{prime}$，$a^{p-1}\equiv 1 \pmod p$。

证明：考察 $P=\{1,2,3,\dots,p-1\}$ 为在 $\text{mod} \ p$ 意义下的完全剩余系，而由引理一，$\{a,2a,3a,\dots,(p-1)a\}$ 亦为一完全剩余系，利用完全剩余系的性质即可得到证明。

此时，$p$ 在 $\text{mod} \ m$ 意义下的乘法逆元 $q=p^{m-2}$，用快速幂计算即可。

## 高斯消元

问题：给定方程组 $\begin{cases}
a_{1,1}x_1+a_{1,2}x_2+\cdots+a_{1,n}x_n=b_1
\\ \ddots \\ a_{n,1}x_1+a_{n,2}x_2+\cdots+a_{n,n}x_n=b_n \end{cases}$，求该方程组的解，或判定解不存在/存在多组解。$n\le 500$。

思考：我们如何手动算出二元一次方程组的解？

程序可以便捷的实现加减消元的过程，称这种算法为高斯消元法。

思考：什么时候方程组无解/存在多组解？

- 无解：存在某一方程组在消元后左侧为零，右侧非零。
- 多解：存在某一方程组在消元后整行全为零。

思考：实现时要注意哪些细节？

注意浮点数运算的精度误差，设置 $\epsilon$ 来消除影响。

## 线性代数初步

### 向量

向量在物理上指“既有大小又有方向的量“，通常，我们用一组数 $(a_1,a_2,a_3,\dots,a_n)$ 来描述一个向量。此时，称 $n$ 为向量的维数。加法、减法和数乘的定义是自然的。

向量是对一组数的打包处理，为向量添加一个额外的纬度，我们就得到了矩阵。

### 矩阵

矩阵是一种结构，其可以写成 $\left[ \begin{array}{ccc}    1 & \cdots & 3 \\    \vdots & \ddots & \vdots \\    7 & \cdots & 9 \end{array} \right] $ 的形式，提供了对数据打包运算的一种方式。称行数和列数相同的矩阵为方阵。对矩阵，我们可以类似向量的定义其加法、减法和数乘，

#### 矩阵乘法

对 $P\times M$ 的矩阵 $A$ 和 $M\times Q$ 的矩阵 $B$，对其做乘法即可得到 $P\times Q$ 的矩阵 $C$。否则，若第一个矩阵的列数不等于第二个矩阵的行数，则无法进行乘法。向量视其横竖，可以分别被视作 $1$ 行 $n$ 列的行向量和 $n$ 行 $1$ 列的列向量。

做乘法时，我们有 $C_{i,j}=\sum_{k=1}^MA_{i,k}B_{k,j}$。

分析：矩阵乘法符合交换律吗？符合结合律吗？符合对矩阵加法的分配律吗？

所有 $n$ 行 $n$ 列的有理矩阵对矩阵乘法构成一个群。

#### 矩阵乘法优化递推

问题：求斐波那契数列的第 $n$ 项对 $p=1000000007$ 取模得到的结果。$n\le 10^{18}$。

矩阵乘法可以帮助我们将一些数据打包处理，且支持结合律，如何应用矩阵乘法以加快计算的速率？  

只需要对向量 $(f_n,\dots)$，构造其到 $(f_{n+1},\dots)$ 的转移即可。

如何用矩阵实现这一过程？

这样做的时间复杂度是多少？

## 群论初步

### 群的定义

群是一种代数结构，包含一个集合 $G$ 和一种二元运算 $\oplus$，且满足如下性质。

- 封闭性：对 $\forall a,b\in G$，有 $(a\oplus b) \in G$。
- 结合律：对 $\forall a,b,c\in G$，有 $(a\oplus b)\oplus c=a\oplus (b\oplus c)$。
- 单位元存在：存在 $e\in G$，对 $\forall a \in G$，$a\oplus e=e\oplus a=a$。此时称 $e$ 为群的单位元。
- 逆元存在：对 $\forall a\in G$，存在 $b\in G$，使得 $a\oplus b=b\oplus a=e$。

对满足交换律的群，即对 $\forall a,b \in G$，满足 $a\oplus b=b\oplus a$，则称群是一个交换群，又称阿贝尔群。

- 群的单位元唯一。
- 群上的消去律存在。
- 元素的逆元唯一。

## 组合数学初步

### 组合数的拓展定义

$n\choose m$ 的上下标拓展问题。


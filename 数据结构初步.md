# 数据结构初步

数据结构，是在程序中用以储存和组织数据的结构。

我们使用数据结构的目的，是方便的对数据进行调用、修改或排序等操作。本质上，数据结构是一种降低程序完成指定目标所需的时间复杂度的方法。由于不同数据结构所适用的场合不同，在信息学竞赛的题目中，往往我们所需要做的便是将不易由数据结构处理的问题转化为可以被数据结构所处理的问题，以此降低问题的时间复杂度。

## 线性数据结构

### 栈

栈是一种线性数据结构，支持在顶部插入一个元素和在顶部删除一个元素两种操作。其具有后进先出的原则。

![img](https://oi-wiki.org/ds/images/stack.svg)

### 队列

队列是一种线性数据结构，支持在顶部插入一个元素和在尾部删除一个元素。其具有先进先出的原则。

![img](https://oi-wiki.org/ds/images/queue.svg)

所常用的还有双端队列，即支持在两端插入和删除元素的数据结构，以及 ```STL``` 所支持的优先队列。尽管优先队列从底层的实现原理上与队列并不一致，我们还是在此介绍优先队列的机制。

优先队列支持两种操作，即插入一个元素和删除队列中最大/最小的一项元素。

### 链表

链表是一种线性数据结构，其以优秀的时间复杂度支持在特定位置插入和删除元素，但以较差的时间复杂度支持查找和读取指定元素。

其原理是我们已经熟悉的。

问题：给定长为 $N=10^5$ 的序列，有两类操作：对某个区间 $[l,r]$ 做循环位移，求某个区间 $[l,r]$ 的和。

## 并查集

问题：给定 $N=5\times 10^6$ 个数，初始每个数都处在一个仅包含它自身的集合当中。给定两种操作：合并 $x,y$ 所在的集合，查询 $x,y$ 是否在相同集合。

并查集是一种用以维护集合的数据结构。

不妨定义 $x \sim y$ 代表 $x,y$ 属于相同集合。不难发现这一关系具有传递性，即若 $x\sim y$，$y\sim z$，则一定有 $x\sim z$。

接下来，思考我们之前所学过的哪种关系具有与此类似的性质？

将问题转化为图上，此时询问变为：每次将给定的两个点之间连一条边，并查询任意两点是否连通。此时，注意到若我们只链接尚未连通的两点，则图一定是一个森林。问题变为判断任意两点是否处在同一颗树内。

问题：给定一个森林，如何判断任意两点是否处在同一颗树内？

为每一棵树确定一个根，记录每个点所对应的根，判断根是否相同即可。

问题：给定一个森林，如何在只遍历一个点到根的路径的前提下，确定一个点的根？

考虑连边时，将树连成有向树中的内向树。具体的，每次链接两个点时，都找到第一个点的根，将该根指向第二个点的根。容易证明，这样所得到的的树一定是一棵内向树。此时找到一个点的根是简单的，只要沿着点的出边一直走即可。

如何用代码实现这一过程？

如何确保这样的做法的时间复杂度？鉴于我们只关心连通性，我们可以优化哪些方面？

- 按秩合并
- 路径压缩

问题：给定 $N=5\times 10^6$ 个数，初始每个数都处在一个仅包含它自身的集合当中。给定两种操作：合并 $x,y$ 所在的集合，查询 $x$ 所在集合的大小和元素和。

https://www.luogu.com.cn/problem/solution/P1196

### 带权并查集和关系并查集

如果要维护的关系不止一种怎么办？

https://www.luogu.com.cn/problem/P2024

### 最小生成树

问题：给定一张 $N\le10^6,M\le 10^6$ 的图，求图的最小生成树。

## ```ST``` 表

```ST``` 表是一类用于解决具有结合律的可重复贡献问题的静态数据结构。

所谓可重复贡献问题，指的是当计算若干个数 $a_1....a_n$ 在该问题下的答案时，对这若干个数去重后得到的结果较去重前的结果不变。 

问题：给定 $N=10^5$ 个数，每次询问 $[l,r]$ 内的最大值。

我们尝试通过对数据进行预先处理来解决这一问题。 

![ST 表示意图](https://oi-wiki.org/ds/images/st.svg)

```ST``` 表通过预先处理原序列中所有长度为 $2^i$ 的连续段的答案，来降低计算最终答案时所需的计算量。容易证明，任意一个被询问的区间 $[l,r]$ 的答案一定可以由两个相同且重叠的 $2^i$ 连续段拼成，取该两个连续段的答案进行计算得到最终答案即可。

思考：该算法的时间复杂度与空间复杂度是？

https://www.luogu.com.cn/problem/P2880

## 猫树

猫树是一种可维护能够快速合并并需满足结合律的信息的数据结构。具有优秀的查询复杂度。此外，猫树是一种静态数据结构。

猫树的原理为，将一个询问区间 $[l,r]$ 分解成两个已经处理过的区间，并快速合并这两个区间的答案。

1. 假设我们当前正在处理的区间是 $[l,r]$，那么我们令 $mid$ 为区间的中点。
2. 从 $mid$ 出发，向左处理信息。譬如当信息是区间和时，我们从 $mid$ 出发，向左做后缀和。而对于问题引入中给出的问题，我们向左不断的往背包中加数，求容量为 $t$ 的背包。
3. 从 $mid+1$ 出发，向右处理信息。手法类似上述。
4. 递归处理区间 $[l,mid] \ 和\ [mid+1,r]$，直至 $l=r$。

即，我们构建一棵具有 $\log n$ 层的树，每层占用空间都为 $n$，因而时间和空间复杂度均为 $O(n \log n)$，是可以接受的。而我们实际上只需要确保询问区间被某个节点所对应的区间完全包含，且 $l,r$ 位居在该区间中点的两侧即可（将该区间称为答案区间）。这一点通过我们如上的建树方式显然可以达成。这样一来，处理询问时，我们只需找到该节点，合并 $[l,mid] \ 和 \ [mid+1,r]$ 两区间即可。